dsl Ness

use Datalake

Datamart(scale = None) master
	Entity(from = dl.userAssertion) User
		Attribute email as String
		Attribute displayName as String
		Attribute name as String
		Attribute language as String

	Entity(from = dl.teamAssertion) Team
		Attribute displayName as String
		Attribute users as Entity(User) List
		Attribute channels as Entity(Channel) List

	Entity(from = dl.channelAssertion) Channel > Attribute displayName as String
	Entity(from = dl.areaAssertion) Area

	Entity(from = dl.analysisAssertion) Analysis
		Attribute observable as String
		Struct Anomaly
			Attribute code as String
			Attribute level as Word("Error" "Warning")
			Attribute period as String
			Attribute triggerValue as String

	Entity Observable as Abstract
		Attribute host as Entity(Observable)
		Attribute observer as Entity(Observable)
		Attribute tags as String List

	Entity Administrable as Abstract ExtensionOf(Observable)
		Attribute team as Entity(Team)
		Attribute area as Entity(Area)

	Entity(from = dl.assetAssertion) Asset as ExtensionOf(Administrable)
	Entity(from = dl.hardwareAssertion) Hardware as ExtensionOf(Administrable)
	Entity(from = dl.peripheralDeviceAssertion) PeripheralDevice as ExtensionOf(Hardware)
	Entity(from = dl.networkDeviceAssertion) NetworkDevice as ExtensionOf(Hardware)
		Attribute ip as String
		Attribute publicIp as String

	Entity(from = dl.machineAssertion) Machine as ExtensionOf(Hardware)
		Attribute architecture as String
		Attribute os as String
		Attribute cores as Integer
		Attribute diskSize as Long  //MB
		Attribute memorySize as Long //MB
		Attribute processes as Integer
		Attribute maxOpenFiles as Long
		Attribute jvm as String
		Attribute isp as String
		Attribute ip as String
		Attribute publicIp as String

	Entity(from = dl.softwareAssertion) Software as ExtensionOf(Administrable)
	Entity(from = dl.consulAssertion) Consul as ExtensionOf(Software)
		Attribute version as String
		Attribute installedActivities as String List
		Attribute enabledActivities as String List

	Entity(from = dl.serviceAssertion) Service as ExtensionOf(Software)
		Attribute url as String
	Entity(from = dl.rdbmsServiceAssertion) RdbmsService as ExtensionOf(Service)
	Entity(from = dl.queryAssertion) Query as ExtensionOf(Observable)
		Attribute query as String
		Attribute hash as String

	Entity(from = dl.applicationAssertion) Application as ExtensionOf(Software)
		Attribute name as String
		Attribute user as String
		Attribute startingTime as DateTime
		Attribute pid as Integer
		Attribute commandLine as String
		Attribute state as Word("NEW" "RUNNING" "SLEEPING" "WAITING" "ZOMBIE" "STOPPED" "OTHER" "INVALID" "SUSPENDED")

	Entity(from = dl.javaApplicationAssertion) JavaApplication as ExtensionOf(Application)
		Attribute classpathPrefix as String
		Attribute mainArtifact as String
		Attribute debugPort as Integer
		Attribute jmxPort as Integer
		Attribute minMemory as Integer
		Attribute maxMemory as Integer
		Attribute classpath as String List
		Attribute inputArguments as String List
		Attribute jvmParameter as String List
		Attribute jvmVersion as String

	Entity(from = dl.personAssertion) Person as ExtensionOf(Observable)
	Entity(from = dl.businessUnitAssertion) BusinessUnit as ExtensionOf(Observable)