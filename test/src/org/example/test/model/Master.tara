dsl Ness

Entity UserInfo
	Attribute username as String
	Attribute password as String
	Attribute role as Word("User" "Admin" "Developer")

Entity MapEntity as Abstract
	Attribute name as String
	Attribute sensId as String

Entity Installation as Abstract ExtensionOf(MapEntity)
	Attribute place as Struct(GeoPoint)
	Method getPlaceWkt as StringGetter("\"POINT(\" + place.latitude() + \" \" + place.longitude() + \")\"")
	Method setPlaceWkt as Routine("place(new GeoPoint(latitude, longitude))")
		Parameter latitude as Double
		Parameter longitude as Double

Entity Videometry as ExtensionOf(Installation)
	Attribute zones as String Set

Entity WeatherStation as ExtensionOf(Installation)
	Attribute url as String

Entity Zone as ExtensionOf(MapEntity)
	Attribute parent as String
	Attribute children as String Set
	Attribute place as Struct(GeoPoint) List
	Method getPlaceWkt as StringGetter("\"POLYGON(\" + place.stream().map(p -> p.latitude() + \" \" + p.longitude()).collect(Collectors.joining(\", \")) + \")\"")

Entity AlertConfiguration
	Attribute entityId as String
	Attribute type as Word("BeachSandOccupancy" "DrySandArea" "WetSandArea" "Tide" "LostConnection")
	Attribute timeScale as Word("Hour" "Day" "Week" "Month" "Year")
	Attribute enabledMin as Boolean
	Attribute min as Double
	Attribute enabledMax as Boolean
	Attribute max as Double

Struct GeoPoint
	Attribute latitude as Double
	Attribute longitude as Double