dsl Ness

use Entities
use Events

Broker(path = empty, port = 63000, secondaryPort = 1884)
	User("trooper", "trooper")
	User("consul", "consul")
	User("connector", "connector")

Datalake(scale = Day, path = "{datalake}") dl
	Seal > Cron(pattern = "0 0 4 1/1 * ? *", timeZone = empty)
	Tank mode as Message(it.Mode)
	Tank assetStatus as Message(it.Status)
	Tank assetInfo as Message(it.Info)
	Tank anomaly as Message(monitoring.AnomalyBundle)
	Tank notification as Message(monitoring.Notification)

	Tank user as Tuple(User)
	Tank team as Tuple(Team)
	Tank type as Tuple (Type)
	Tank area as Tuple (Area)
	Tank host as Tuple (Host)
	Tank asset as Tuple (Asset)
	Tank system as Tuple (System)
	Tank assetType as Tuple (AssetType)
	Tank service as Tuple(Service)
	Tank serviceType as Tuple (ServiceType)
	Tank businessType as Tuple (BusinessType)
	Tank anomalyRule as Tuple(AnomalyType)
	Tank anomalyType as Tuple(AnomalyRule)

Terminal test-terminal
	Subscribe(dl.anomaly dl.assetInfo dl.assetStatus dl.mode, dl.user dl.asset dl.service dl.team dl.type dl.assetType dl.serviceType dl.area dl.host dl.anomalyType dl.system)
	Publish(dl.notification, dl.service dl.team dl.anomalyType dl.system)

Terminal monitor-terminal
	Publish(dl.assetInfo dl.assetStatus dl.mode)
	Subscribe(empty, dl.service)

Terminal wizard-terminal
	Publish(dl.anomaly)
	Subscribe(dl.mode dl.assetInfo dl.assetStatus,dl.asset dl.service dl.anomalyType dl.anomalyRule)
	Datamarts(d1 d2 d3...)

Terminal connector-terminal
	Publish(empty, dl.user dl.team)
	Subscribe(dl.notification, dl.user dl.team)